---
title: JVM 对象的内存布局
date: 2020-08-14 00:35:32
tags: [Java]
---

### JVM 对象的内存布局

- 运行时数据区域
    - 程序计数器 （字节码寻址的索引）
    - Java 虚拟机栈（栈内存，存储局部变量，操作数栈）
    - 本地方法栈（Native 方法的栈内存）
    - Java 堆（线程共享的区域，用于存放对象实例，GC 的核心区域，可以物理上不连续）
    - 方法区（线程共享区域，已被虚拟机加载的类信息、常量、静态变量、JIT 代码）
    - 运行时常量池（编译器生成的字面量和符号引用）
    - 直接内存（用于提高 NIO 性能）
- 

> 引用

<!--分割线-->

<!--more-->

### 创建对象的方式


1. new 语句  （构造器）
2. 反射Class.forName（构造器）
3. Object.clone （基于已有数据）
4. 反序列化 （基于已有数据）
5. Unsafe.allocateInstance （没有初始化实例字段）



### 压缩指针

1. new 创建会涵盖父类中对象实例的字段
2. 一般情况下，对象头（128-bit object header）
    2.1 64-bit-标记字段 8 byte 
    2.2 64-bit-类型指针 8byte
3. 压缩指针（压缩类型指针）
    3.1 64-bit-标记字段 8 byte 
    3.2 632-bit-类型指针 4 byte


### 字段重排序

Java虚拟机重新分配字段的先后顺序，达到内存对齐的目的。



 




