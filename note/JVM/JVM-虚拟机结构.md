---
title: Java 虚拟机结构
date: 2020-09-27 16:55:28
tags: [JVM]
---

### Java 虚拟机结构

虚拟机的结构文档只规定了抽象的，不涉及到 Java 虚拟机的具体实现。

实现 Java 虚拟机的条件是具备读取 `class` 文件的能力，而实际上的具体实现都可以由开发者自行实现。

> 值得一提的是：方法区是 JVM 的规范规定的存放类信息和静态变量的区域，在 1.7 之前使用永久代实现，而之后在 1.8 改成使用了元空间。

<!--分割线-->

<!--more-->


### `class` 文件的格式

虚拟机执行的代码是直接独立于硬件和操作系统的二进制指令，通常来说直接存储于一个 `class` 文件中。一个 `class` 文件包含了一个类或者接口的所有信息。

class 文件格式的具体标准件参见[TODO](TODO)


### 数据类型

如同 Java 语言的声明的一样，Java 虚拟机操作两种数据类型：基本类型和引用类型。可以将这两种数据作为变量，方法的参数或者返回值。

Java虚拟机要求几乎所有的类型检查要在运行前执行完，这部分实现是由编译器实现的。基本类型的值无需在运行时确定类型或者与引用类型区分开。相反的，Java 虚拟机指令集声明了针对不同基本类型的操作指令。例如：`iadd`、`ladd`、`fadd` 和 `dadd` 是 Java 虚拟机中对于 `int`、`long`、`float` 和 `double` 的二元加法指令。

#### 八种基本类型

Java 虚拟机中支持的类型可以直接分为三类：数值类型（`numeric`）、布尔类型（`boolean`）和地址类型（`returnAddress`）。

- 数值类型（`numeric`）
    - 整型数值
        - `byte`    8  位带符号的二进制补码整数，默认值为 0；
        - `short`   16 位带符号的二进制补码整数，默认值为 0；
        - `int`     32 位带符号的二进制补码整数，默认值为 0；
        - `long`    64 位带符号的二进制补码整数，默认值为 0；
        - `char`    16 位无符号的二进制补码整数，用于表示 UTF-16 编码的 Unicode 字符，默认值是空编码（'\u0000'）

    - 浮点数值
        - `float`   定义于单精度浮点数集合（或者是拓展单精度浮点数集合）中的元素，默认值为正零；
        - `double`  定义于双精度浮点数集合（或者是拓展双精度浮点数集合）中的元素，默认值为正零；

- 布尔类型（`boolean`）
    
    `boolean` 类型的取值只有 `true` 和 `false`，默认值是 `false`；

- 地址类型（`returnAddress`）

    `returnAddress` 类型是指向 Java 虚拟机指令的指针。
    > 在基本类型中， `returnAddress` 类型并不对应 Java 中的类型。

#### 整数类型和值

Java 虚拟机中，整型的取值范围为：

- 对于 `byte`  类型，其取值范围为 [-2^7 , 2^7-1 ]；
- 对于 `short` 类型，其取值范围为 [-2^15, 2^16-1]；
- 对于 `int`   类型，其取值范围为 [-2^31, 2^31-1]；
- 对于 `long`  类型，其取值范围为 [-2^63, 2^63-1]；
- 对于 `char`  类型，其取值范围为 [0    , 65535 ]；

#### 浮点型的类型、值域和值










